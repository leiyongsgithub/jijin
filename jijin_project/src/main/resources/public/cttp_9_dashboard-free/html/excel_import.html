<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>excel 导入</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/animate.min.css" rel="stylesheet"/>
    <link href="../assets/css/paper-dashboard.css" rel="stylesheet"/>
    <link href="../assets/css/demo.css" rel="stylesheet" />
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href="../assets/css/themify-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/fileinput.min.css"/>
</head>
<body>
<div class="wrapper">
    <div class="sidebar" data-background-color="white" data-active-color="danger">
    	<div class="modal-header">
		    <h5 class="modal-title">Excel文件上传</h5>
		</div>
		<div class="modal-body">
		    <form id="importFile" name="importFile" class="form-horizontal" method="post"
		          enctype="multipart/form-data">
		        <div class="box-body">
		            <div>
		                <label class="control-label">请选择要导入的Excel文件：</label>
		                <input id="txt_file" name="excelFile" class="file-loading" type="file" multiple accept=".xls,.xlsx"> <br>
<!-- 		            	<input type="file" name="excelFile" id="txt_file" multiple class="file-loading" /> -->
		            </div>
		        </div>
		    </form>
		</div>
    </div>
</div>
</body>

    <!--   Core JS Files   -->
    <script src="../assets/js/jquery-1.10.2.js" type="text/javascript"></script>
	<script src="../assets/js/bootstrap.min.js" type="text/javascript"></script>
	<!--  Checkbox, Radio & Switch Plugins -->
	<script src="../assets/js/bootstrap-checkbox-radio.js"></script>
	<!--  Charts Plugin -->
	<script src="../assets/js/chartist.min.js"></script>
    <!--  Notifications Plugin    -->
    <script src="../assets/js/bootstrap-notify.js"></script>
    <!--  Google Maps Plugin    -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js"></script>
    <!-- Paper Dashboard Core javascript and methods for Demo purpose -->
	<script src="../assets/js/paper-dashboard.js"></script>
	<!-- Paper Dashboard DEMO methods, don't include it in your project! -->
	<script src="../assets/js/demo.js"></script>
	<script src="../js/fileinput.min.js"></script>
<script src="../js/zh.js"></script>
<script>
	$(function () {
		//0.初始化fileinput
		var oFileInput = new FileInput();
		oFileInput.Init("txt_file", "http://localhost:9999/jijin/import");
	});
		//初始化fileinput
	var FileInput = function () {
		var oFile = new Object();
		//初始化fileinput控件（第一次初始化）
		oFile.Init = function(ctrlName, uploadUrl) {
			var control = $('#' + ctrlName);
	        control.fileinput({
	            language: 'zh', //设置语言
	            uploadUrl: uploadUrl, //上传的地址
	            uploadAsync: true, //默认异步上传
	            showCaption: true,//是否显示标题
	            showUpload: true, //是否显示上传按钮
	            browseClass: "btn btn-primary", //按钮样式
	            allowedFileExtensions: ["xls", "xlsx"], //接收的文件后缀
	            maxFileCount: 10,//最大上传文件数限制
	            previewFileIcon: '<i class="glyphicon glyphicon-file"></i>',
	            showPreview: true, //是否显示预览
	            previewFileIconSettings: {
	                'docx': '<i ass="fa fa-file-word-o text-primary"></i>',
	                'xlsx': '<i class="fa fa-file-excel-o text-success"></i>',
	                'xls': '<i class="fa fa-file-excel-o text-success"></i>',
	                'pptx': '<i class="fa fa-file-powerpoint-o text-danger"></i>',
	                'jpg': '<i class="fa fa-file-photo-o text-warning"></i>',
	                'pdf': '<i class="fa fa-file-archive-o text-muted"></i>',
	                'zip': '<i class="fa fa-file-archive-o text-muted"></i>',
	            },
	            uploadExtraData: function () {
	                var extraValue = "test";
	                return {"excelType": extraValue};
	            }
	        });
		}
		return oFile;
	};
	 $("#txt_file").on("fileuploaded", function (event, data, previewId, index) {
	        console.log(data);
	        if(data.response == 1000)
	        {
	            alert("上传成功!");
	        //关闭
	            $(".close").click();
	        }
	        else{
	            alert(data.response);
	        //重置
	        $("#excelFile").fileinput("clear");
	        $("#excelFile").fileinput("reset");
	        $('#excelFile').fileinput('refresh');
	        $('#excelFile').fileinput('enable');
	        }
	    });
</script>

</html>
