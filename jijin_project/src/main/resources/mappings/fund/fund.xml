<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.test.spring.boot.jijin.fund.dao.FundDao">
	<insert id="save" parameterType="com.test.spring.boot.jijin.fund.entity.FundEntity">
        insert into fund
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="fundId != null">fund_id,</if>
            <if test="fundName != null">fund_name,</if>
            <if test="top10 != null">top_10,</if>
            <if test="date != null">date</if>
        </trim>
        <trim prefix="values(" suffix=")" suffixOverrides=",">
            <if test="fundId != null">#{fundId},</if>
            <if test="fundName != null">#{fundName},</if>
            <if test="top10 != null">#{top10},</if>
            <if test="date != null">#{date},</if>
        </trim>
    </insert>
    
    <resultMap id="pageMap" type="com.test.spring.boot.jijin.fund.entity.PageFundEntity" >
        <result property="fundId" column="fund_id"/>
        <result property="fundName" column="fund_name"/>
        <result property="top10" column="top_10"/>
        <result property="date" column="date"/>
		<result property="sharesId" column="shares_id"/>
		<result property="sharesName" column="shares_name"/>
		<result property="holdingRatio" column="holding_ratio"/>
    </resultMap>
    <sql id="pageColumn">
    	f.fund_id,f.fund_name,f.top_10,f.date,
    	s.shares_id,s.shares_name,
    	fs.holding_ratio
    </sql>
    <select id="pageQuery" parameterType="com.test.spring.boot.jijin.fund.param.PageParam" resultMap="pageMap">
    	select <include refid="pageColumn"/>
    		from fund f  join fund_shares fs on f.fund_id = fs.fund_id
    					 join shares s on fs.shares_id = s.shares_id
		    <where>
		    	<if test="top10 != null">and f.top_10=#{top10}</if>
		    </where>    		
    </select>
</mapper>